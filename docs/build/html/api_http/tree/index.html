<!DOCTYPE html>


<html xmlns="http://www.w3.org/1999/xhtml">
  <head>
    <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
    
    <title>/api/tree &mdash; OpenTDSB 2.0 documentation</title>
    
    <link rel="stylesheet" href="../../_static/solar.css" type="text/css" />
    <link rel="stylesheet" href="../../_static/pygments.css" type="text/css" />
    
    <script type="text/javascript">
      var DOCUMENTATION_OPTIONS = {
        URL_ROOT:    '../../',
        VERSION:     '2.0',
        COLLAPSE_INDEX: false,
        FILE_SUFFIX: '.html',
        HAS_SOURCE:  true
      };
    </script>
    <script type="text/javascript" src="../../_static/jquery.js"></script>
    <script type="text/javascript" src="../../_static/underscore.js"></script>
    <script type="text/javascript" src="../../_static/doctools.js"></script>
    <link rel="top" title="OpenTDSB 2.0 documentation" href="../../index.html" />
    <link rel="up" title="HTTP API" href="../index.html" />
    <link rel="next" title="/api/tree/rule" href="rule.html" />
    <link rel="prev" title="/api/suggest" href="../suggest.html" /><link href='http://fonts.googleapis.com/css?family=Source+Code+Pro|Open+Sans:300italic,400italic,700italic,400,300,700' rel='stylesheet' type='text/css'>
<link href="../../_static/solarized-dark.css" rel="stylesheet">
  </head>
  <body>
    <div class="related">
      <h3>Navigation</h3>
      <ul>
        <li class="right" style="margin-right: 10px">
          <a href="../../genindex.html" title="General Index"
             accesskey="I">index</a></li>
        <li class="right" >
          <a href="rule.html" title="/api/tree/rule"
             accesskey="N">next</a> |</li>
        <li class="right" >
          <a href="../suggest.html" title="/api/suggest"
             accesskey="P">previous</a> |</li>
        <li><a href="../../index.html">OpenTDSB 2.0 documentation</a> &raquo;</li>
          <li><a href="../index.html" accesskey="U">HTTP API</a> &raquo;</li> 
      </ul>
    </div>
      <div class="sphinxsidebar">
        <div class="sphinxsidebarwrapper">
  <h3><a href="../../index.html">Table Of Contents</a></h3>
  <ul>
<li><a class="reference internal" href="#">/api/tree</a><ul>
<li><a class="reference internal" href="#tree-api-endpoints">Tree API Endpoints</a><ul>
</ul>
</li>
<li><a class="reference internal" href="#verbs">Verbs</a></li>
<li><a class="reference internal" href="#requests">Requests</a></li>
<li><a class="reference internal" href="#response">Response</a></li>
<li><a class="reference internal" href="#get">GET</a><ul>
<li><a class="reference internal" href="#example-get-all-trees-query">Example GET All Trees Query</a></li>
<li><a class="reference internal" href="#example-response">Example Response</a></li>
<li><a class="reference internal" href="#example-get-single-tree">Example GET Single Tree</a></li>
<li><a class="reference internal" href="#id5">Example Response</a></li>
</ul>
</li>
<li><a class="reference internal" href="#post-put">POST/PUT</a><ul>
<li><a class="reference internal" href="#example-post-create-request">Example POST Create Request</a></li>
<li><a class="reference internal" href="#id6">Example Response</a></li>
<li><a class="reference internal" href="#example-post-edit-request">Example POST Edit Request</a></li>
<li><a class="reference internal" href="#id7">Example Response</a></li>
</ul>
</li>
<li><a class="reference internal" href="#delete">DELETE</a><ul>
<li><a class="reference internal" href="#example-delete-request">Example DELETE Request</a></li>
<li><a class="reference internal" href="#id8">Example Response</a></li>
</ul>
</li>
</ul>
</li>
</ul>

  <h4>Previous topic</h4>
  <p class="topless"><a href="../suggest.html"
                        title="previous chapter">/api/suggest</a></p>
  <h4>Next topic</h4>
  <p class="topless"><a href="rule.html"
                        title="next chapter">/api/tree/rule</a></p>
<div id="searchbox" style="display: none">
  <h3>Quick search</h3>
    <form class="search" action="../../search.html" method="get">
      <input type="text" name="q" />
      <input type="submit" value="Go" />
      <input type="hidden" name="check_keywords" value="yes" />
      <input type="hidden" name="area" value="default" />
    </form>
    <p class="searchtip" style="font-size: 90%">
    Enter search terms or a module, class or function name.
    </p>
</div>
<script type="text/javascript">$('#searchbox').show(0);</script>
        </div>
      </div>

    <div class="document">
      <div class="documentwrapper">
        <div class="bodywrapper">
          <div class="body">
            
  <div class="section" id="api-tree">
<h1>/api/tree</h1>
<p>Trees are meta data used to organize time series in a heirarchical structure for browsing similar to a typical file system. The tree endpoing enables creating, modifying or deleting trees, rules and fetching generated branches.</p>
<div class="section" id="tree-api-endpoints">
<h2>Tree API Endpoints</h2>
<div class="toctree-wrapper compound">
<ul>
<li class="toctree-l1"><a class="reference internal" href="rule.html">/api/tree/rule</a></li>
</ul>
</div>
</div>
<div class="section" id="verbs">
<h2>Verbs</h2>
<ul class="simple">
<li>GET - Retrieve one or more tree definitions</li>
<li>POST - Edit tree fields</li>
<li>PUT - Replace tree feidls</li>
<li>DELETE - Delete a tree and all associated meta data</li>
</ul>
</div>
<div class="section" id="requests">
<h2>Requests</h2>
<p>The following fields can be used for all tree endpoint requests:</p>
<table border="1" class="docutils">
<colgroup>
<col width="10%" />
<col width="5%" />
<col width="5%" />
<col width="45%" />
<col width="10%" />
<col width="5%" />
<col width="5%" />
<col width="15%" />
</colgroup>
<thead valign="bottom">
<tr class="row-odd"><th class="head">Name</th>
<th class="head">Data Type</th>
<th class="head">Required</th>
<th class="head">Description</th>
<th class="head">Default</th>
<th class="head">QS</th>
<th class="head">RW</th>
<th class="head">Example</th>
</tr>
</thead>
<tbody valign="top">
<tr class="row-even"><td>tree</td>
<td>Integer</td>
<td>Required*</td>
<td>Used to fetch or modify a specific tree. <a href="#id1"><span class="problematic" id="id2">*</span></a>When creating a new tree, the &#8216;&#8217;tree&#8217; value must not be present.</td>
<td>&nbsp;</td>
<td>tree</td>
<td>RO</td>
<td>1</td>
</tr>
<tr class="row-odd"><td>name</td>
<td>String</td>
<td>Required*</td>
<td>A brief, descriptive name for the tree. <a href="#id3"><span class="problematic" id="id4">*</span></a>Required only when creating a tree.</td>
<td>&nbsp;</td>
<td>name</td>
<td>RW</td>
<td>Network Infrastructure</td>
</tr>
<tr class="row-even"><td>description</td>
<td>String</td>
<td>Optional</td>
<td>A longer description of what the tree contains</td>
<td>&nbsp;</td>
<td>description</td>
<td>RW</td>
<td>Tree containing all network gearl</td>
</tr>
<tr class="row-odd"><td>notes</td>
<td>String</td>
<td>Optional</td>
<td>Detailed notes about the tree</td>
<td>&nbsp;</td>
<td>notes</td>
<td>RW</td>
<td>&nbsp;</td>
</tr>
<tr class="row-even"><td>strictMatch</td>
<td>Boolean</td>
<td>Optional</td>
<td>Whether or not timeseries should be included in the tree if they fail to match one or more rule levels.</td>
<td>false</td>
<td>strict_match</td>
<td>true</td>
<td>&nbsp;</td>
</tr>
</tbody>
</table>
</div>
<div class="section" id="response">
<h2>Response</h2>
<p>A successful response to a <tt class="docutils literal"><span class="pre">GET</span></tt>, <tt class="docutils literal"><span class="pre">POST</span></tt> or <tt class="docutils literal"><span class="pre">PUT</span></tt> request will return tree objects with optinally requested changes. Successful <tt class="docutils literal"><span class="pre">DELETE</span></tt> calls will return with a <tt class="docutils literal"><span class="pre">204</span></tt> status code and no body content. When modifying data, if no changes were present, i.e. the call did not provide any data to store, the resposne will be a <tt class="docutils literal"><span class="pre">304</span></tt> without any body content. If the requested tree did not exist in the system, a <tt class="docutils literal"><span class="pre">404</span></tt> will be returned with an error message. If invalid data was supplied an &#8216;&#8216;400&#8217;&#8217; error will be returned.</p>
<p>All <strong>Request</strong> fields will be present in the response in addition to others:</p>
<table border="1" class="docutils">
<colgroup>
<col width="10%" />
<col width="10%" />
<col width="60%" />
<col width="20%" />
</colgroup>
<thead valign="bottom">
<tr class="row-odd"><th class="head">Name</th>
<th class="head">Data Type</th>
<th class="head">Description</th>
<th class="head">Example</th>
</tr>
</thead>
<tbody valign="top">
<tr class="row-even"><td>rules</td>
<td>Map</td>
<td>A map or dictionary with rules defined for the tree organized by &#8216;&#8217;level&#8217;&#8217; and &#8216;&#8217;order&#8217;&#8216;. If no rules have been defined yet, the value will be &#8216;&#8217;null&#8217;&#8216;</td>
<td><em>See Examples</em></td>
</tr>
<tr class="row-odd"><td>created</td>
<td>Integer</td>
<td>A Unix Epoch timestamp in seconds when the tree was originally created.</td>
<td>1350425579</td>
</tr>
</tbody>
</table>
</div>
<div class="section" id="get">
<h2>GET</h2>
<p>A &#8216;&#8217;GET&#8217;&#8217; request to &#8216;&#8217;/api/tree&#8217;&#8217; without a tree ID will return a list of all of the trees configured in the system. The results will include configured rules for each tree. If no trees have been configured yet, the list will be empty.</p>
<div class="section" id="example-get-all-trees-query">
<h3>Example GET All Trees Query</h3>
<div class="highlight-python"><pre>http://localhost:4242/api/tree</pre>
</div>
</div>
<div class="section" id="example-response">
<h3>Example Response</h3>
<p>To fetch a specific tree, supply a &#8216;&#8217;tree&#8217; value. The response will include the tree object if found. If the requested tree does not exist, a 404 exception will be returned.</p>
</div>
<div class="section" id="example-get-single-tree">
<h3>Example GET Single Tree</h3>
<p>:;</p>
<blockquote>
<div><a class="reference external" href="http://localhost:4242/api/tree?tree=1">http://localhost:4242/api/tree?tree=1</a></div></blockquote>
</div>
<div class="section" id="id5">
<h3>Example Response</h3>
</div>
</div>
<div class="section" id="post-put">
<h2>POST/PUT</h2>
<p>Using the &#8216;&#8217;POST&#8217;&#8217; or &#8216;&#8217;PUT&#8217;&#8217; methods, you can create a new tree or edit most of the fiels for an existing tree. New trees require a &#8216;&#8217;name&#8217; value and for the &#8216;&#8217;tree&#8217; value to be empty. Existing trees require a valid &#8216;&#8217;tree&#8217;&#8217; ID and any fields that require modification. A successful request will return the modified tree object.</p>
<div class="section" id="example-post-create-request">
<h3>Example POST Create Request</h3>
<div class="highlight-python"><pre>http://localhost:4242/api/tree?name=Network%20Tree&amp;method=post</pre>
</div>
</div>
<div class="section" id="id6">
<h3>Example Response</h3>
</div>
<div class="section" id="example-post-edit-request">
<h3>Example POST Edit Request</h3>
<div class="highlight-python"><pre>http://localhost:4242/api/tree?tree=1&amp;description=Network%20Device%20Information&amp;method=post</pre>
</div>
</div>
<div class="section" id="id7">
<h3>Example Response</h3>
</div>
</div>
<div class="section" id="delete">
<h2>DELETE</h2>
<p>Using the &#8216;&#8217;DELETE&#8217;&#8217; method will remove a tree, rules, collisions, not matched entries and all branches from storage. This endpoint starts a delete. Because the delete can take some time, the endpoint will return a successful 204 response without data if the delete was able to start. If the tree was not found, it will return a 404.</p>
<div class="admonition warning">
<p class="first admonition-title">Warning</p>
<p class="last">This method cannot be undone. Once executed, the purge will continue running unless the TSD is shutdown.</p>
</div>
<div class="admonition note">
<p class="first admonition-title">Note</p>
<p class="last">Before executing a &#8216;&#8217;DELETE&#8217;&#8217; query, you should make sure that a manual tree syncronization is not running somehwere on your data. If it is, there may be some orphaned branches or leaves stored during the purge. Use the _____ CLi tool sometime after the delete to cleanup left over branches or leaves.</p>
</div>
<div class="section" id="example-delete-request">
<h3>Example DELETE Request</h3>
<div class="highlight-python"><pre>http://localhost:4242/api/tree?tree=1&amp;method=delete</pre>
</div>
</div>
<div class="section" id="id8">
<h3>Example Response</h3>
</div>
</div>
</div>


          </div>
        </div>
      </div>
      <div class="clearer"></div>
    </div>
    <div class="related">
      <h3>Navigation</h3>
      <ul>
        <li class="right" style="margin-right: 10px">
          <a href="../../genindex.html" title="General Index"
             >index</a></li>
        <li class="right" >
          <a href="rule.html" title="/api/tree/rule"
             >next</a> |</li>
        <li class="right" >
          <a href="../suggest.html" title="/api/suggest"
             >previous</a> |</li>
        <li><a href="../../index.html">OpenTDSB 2.0 documentation</a> &raquo;</li>
          <li><a href="../index.html" >HTTP API</a> &raquo;</li> 
      </ul>
    </div>
    <div class="footer">
        &copy; Copyright 2013, OpenTSDB.
    Created using <a href="http://sphinx.pocoo.org/">Sphinx</a> 1.2pre.Theme by <a href="http://github.com/vkvn">vkvn</a>
    </div>
  </body>
</html>